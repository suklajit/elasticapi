package co.nz.csoft.elasticsearch.controller;

import java.io.IOException;
import java.time.LocalDate;
import java.time.ZoneId;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Collections;
import java.util.Comparator;
import java.util.Date;
import java.util.HashMap;
import java.util.HashSet;
import java.util.LinkedHashMap;
import java.util.LinkedHashSet;
import java.util.List;
import java.util.Map;
import java.util.Objects;
import java.util.Set;
import java.util.concurrent.CompletableFuture;
import java.util.stream.Collectors;
import org.springframework.data.domain.Sort;
import org.elasticsearch.action.search.ClearScrollRequest;
import org.elasticsearch.action.search.SearchRequest;
import org.elasticsearch.action.search.SearchResponse;
import org.elasticsearch.action.search.SearchScrollRequest;
import org.elasticsearch.client.RequestOptions;
import org.elasticsearch.client.RestHighLevelClient;
import org.elasticsearch.common.unit.Fuzziness;
import org.elasticsearch.common.unit.TimeValue;
import org.elasticsearch.index.query.BoolQueryBuilder;
import org.elasticsearch.index.query.MultiMatchQueryBuilder;
import org.elasticsearch.index.query.QueryBuilder;
import org.elasticsearch.index.query.QueryBuilders;
import org.elasticsearch.search.Scroll;
import org.elasticsearch.search.builder.SearchSourceBuilder;
import org.elasticsearch.search.sort.FieldSortBuilder;
import org.elasticsearch.search.sort.SortBuilders;
import org.elasticsearch.search.sort.SortOrder;
import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.data.elasticsearch.core.query.FetchSourceFilter;
import org.springframework.data.elasticsearch.core.query.NativeSearchQuery;
import org.springframework.data.elasticsearch.core.query.NativeSearchQueryBuilder;
import org.springframework.http.HttpStatus;
import org.springframework.http.ResponseEntity;
import org.springframework.scheduling.annotation.Scheduled;
import org.springframework.web.bind.annotation.GetMapping;
import org.springframework.web.bind.annotation.PathVariable;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestBody;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.RequestMethod;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.bind.annotation.RestController;
import org.springframework.web.server.ResponseStatusException;
import org.elasticsearch.index.query.QueryBuilders;
import co.nz.csoft.elasticsearch.dto.HotelStaticDataDto;
import co.nz.csoft.elasticsearch.dto.PaginatedResponse;
import co.nz.csoft.elasticsearch.model.CityLocation;
import co.nz.csoft.elasticsearch.model.HotelLocation;
import co.nz.csoft.elasticsearch.model.HotelSearchDocument;
import co.nz.csoft.elasticsearch.model.HotelStaticData;
import co.nz.csoft.elasticsearch.model.PropertyName;
import co.nz.csoft.elasticsearch.model.PropertySearchDocument;
import co.nz.csoft.elasticsearch.repository.HotelSearchRepository;
import co.nz.csoft.elasticsearch.repository.HotelStaticDataRepo;
import co.nz.csoft.elasticsearch.service.HotelStaticDataService;
import co.nz.csoft.elasticsearch.thm.dto.ThmPropertyDto;
import org.elasticsearch.client.Request;
import org.elasticsearch.client.Response;
import org.apache.http.util.EntityUtils;
import org.apache.lucene.search.spell.LevenshteinDistance;
import org.springframework.data.domain.Page;
import org.springframework.data.domain.PageRequest;
import org.springframework.data.domain.Pageable;
import org.springframework.data.elasticsearch.core.ElasticsearchOperations;
import org.springframework.data.elasticsearch.core.SearchHits;
import org.springframework.data.elasticsearch.core.query.Query;
import org.springframework.format.annotation.DateTimeFormat;

import static org.elasticsearch.index.query.QueryBuilders.multiMatchQuery;
import org.springframework.data.elasticsearch.core.SearchHit;
import org.springframework.data.elasticsearch.core.SearchHits;

@RestController
@RequestMapping(value = "/api")
public class PropertyDataController {

	@Autowired
	private HotelStaticDataService hotelStaticDataService;
	@Autowired
	private HotelSearchRepository hotelSearchRepository;

	@Autowired
	private HotelStaticDataRepo hotelStaticDataRepo;

	@Autowired
	private ElasticsearchOperations elasticsearchOperations;

	@Autowired
	private RestHighLevelClient restHighLevelClient;
	
	
	@GetMapping("/searchFeaturedProperties")
	public PaginatedResponse searchFeaturedProperties(
	        @RequestParam(defaultValue = "0") int page,
	        @RequestParam(defaultValue = "10") int size) throws IOException {

	    // Use your static list of PROPERTY_IDS
		/*
	    List<Long> FEATURED_PROPERTY_IDS = Arrays.asList(
			    2508L,2474L,2697L,2543L,1231L,2887L,1953L,1610L,1352L,2536L,
			    434L,916L,1213L,2665L,2744L,1240L,2468L,1587L,2612L,2976L,
			    2654L,2568L,315L,2389L,1856L,2167L,1092L,1665L,1703L,2499L,
			    2593L,1704L,1090L,2428L,1483L,2662L,2966L,2978L,2876L,1490L,
			    2808L,2792L,1867L,2786L,2760L,2796L,2881L,2889L,2763L,1425L,
			    2150L,740L,902L,928L,961L,1347L,1399L,1418L,1431L,1449L,1504L,
			    1525L,1535L,1554L,1576L,1588L,1589L,1592L,1595L,1615L,1631L,
			    1637L,1644L,1746L,1747L,1792L,1914L,1940L,1941L,1944L,1948L,
			    1949L,2004L,2006L,2011L,2015L,2016L,2078L,2141L,2151L,2172L,
			    2174L,2179L,2185L,2187L,2191L,2194L,2192L,2214L,2215L,2216L,
			    2217L,2221L,2222L,2223L,2224L,2228L,2233L,2237L,2251L,2257L,
			    2265L,2267L,2278L,2281L,2304L,2315L,2317L,2318L,2321L,2326L,
			    2327L,2331L,2336L,2337L,2338L,2339L,2349L,2351L,2354L,2356L,
			    2374L,2376L,2392L,2399L,2400L,2401L,2402L,2405L,2409L,2410L,
			    2411L,2413L,2417L,2421L,2429L,2432L,2434L,2436L,2443L,2444L,
			    2445L,2446L,2447L,2448L,2449L,2450L,2455L,2456L,2461L,2464L,
			    2465L,2467L,2471L,2473L,2480L,2483L,2484L,2497L,2501L,2513L,
			    2519L,2544L,2546L,2550L,2555L,2564L,2590L,2595L,2603L,2674L,
			    2680L,2694L,2727L,2728L,2732L,2735L,2736L,2759L,2782L,2785L,
			    2787L,2791L,2794L,2805L,2836L,2838L,2847L,2854L,2910L,2931L,
			    2932L,2940L,2942L,2948L,2949L,2951L,2971L,2973L,2979L,2982L,
			    2987L,2992L,2995L,3023L,3034L,3035L,3040L,3044L,3055L,3056L,
			    3057L,3058L,3059L,3061L,3062L,3063L,3064L,3067L,3068L,3075L,
			    3079L,3080L,3081L,3084L,3088L,3091L,3092L,3106L,3111L,3118L,
			    3119L,3120L,3121L,3122L,3124L,3125L,3126L,3127L,3128L,3129L,
			    3130L,3131L,3132L,3133L,3134L,3135L,3136L,3137L,3138L,3139L,
			    3140L,3141L,3142L,3143L,3144L,3145L,3146L,3147L,3148L,3149L,
			    3150L,3151L,3152L,3153L,3154L,3155L,3156L,3157L,3158L,3159L,
			    3160L,3161L,3162L,3163L,3164L,3165L,3166L,3167L,3168L,3169L,
			    3170L,3171L,3172L,3173L,3174L,3176L,3177L,3178L,3179L,3180L,
			    3181L,3182L,3183L,3184L,3185L,3186L,3187L,3188L,3189L,3190L,
			    3192L,3193L,3194L,3195L,3196L,3197L,3199L,3200L,3201L,3203L,
			    3204L,3205L,3206L,3207L,3208L,3209L,3210L,3211L,3212L,3213L,
			    3214L,3215L,3216L,3217L,3218L,3219L,3220L,3221L,3222L,3223L,
			    3225L,3226L,3227L,3228L,3229L,3230L,3231L,3232L,3233L,3234L,
			    3235L,3236L,3237L,3238L,3239L,3240L,3241L,3242L,3243L,3244L,
			    3245L,3246L,3247L,3248L,3249L,3250L,3251L,3252L,3254L,3255L,
			    3256L,3258L,3259L,3260L,3261L,3262L,3263L,3264L,3265L,3266L,
			    3267L,3268L,3269L,3270L,3271L,3274L,3275L,3276L,3277L,3278L,
			    3279L,3280L,3281L
			);
*/
		 List<Long> FEATURED_PROPERTY_IDS = Arrays.asList(
		1867L,2786L,2760L,2796L,2881L,2889L,2763L,1425L,2150L,740L,902L,928L,961L,1347L,1399L,1449L,1504L,1535L,1554L,1588L,1589L,1592L,1595L,1615L,1631L,1644L,1940L,1941L,1944L,1948L,1949L,2004L,2011L,2015L,2078L,2141L,2151L,2172L,2174L,2179L,2191L,2194L,2192L,2216L,2221L,2222L,2237L,2257L,2265L,2267L,2278L,2281L,2315L,2317L,2321L,2326L,2327L,2331L,2336L,2337L,2338L,2339L,2351L,2354L,2374L,2399L,2401L,2405L,2411L,2411L,2429L,2432L,2434L,2443L,2445L,2446L,2447L,2448L,2449L,2450L,2455L,2456L,2461L,2464L,2465L,2467L,2471L,2473L,2480L,2483L,2484L,2501L,2513L,2519L,2544L,2546L,2555L,2564L,2590L,2595L,2674L,2680L,2694L,2727L,2728L,2732L,2735L,2736L,2759L,2782L,2785L,2787L,2791L,2794L,2805L,2836L,2838L,2847L,2854L,2931L,2940L,2948L,2951L,2973L,2979L,2982L,2987L,2992L,2995L,3023L,3035L,3055L,3056L,3057L,3059L,3062L,3063L,3064L,3075L,3079L,3080L,3084L,3088L,3091L,3092L,3111L,3118L,3119L,3120L,3121L,3122L,3124L,3125L,3126L,3127L,3128L,3130L,3132L,3133L,3135L,3138L,3139L,3140L,3141L,3142L,3143L,3144L,3145L,3146L,3147L,3148L,3149L,3150L,3151L,3152L,3153L,3154L,3156L,3157L,3158L,3159L,3160L,3161L,3162L,3163L,3164L,3165L,3166L,3167L,3168L,3169L,3171L,3172L,3173L,3174L,3177L,3178L,3179L,3180L,3181L,3182L,3183L,3184L,3185L,3186L,3187L,3188L,3189L,3190L,3192L,3197L,3217L,3223L,3231L,3233L,3234L,3235L,3236L,3237L,3238L,3239L,3240L,3241L,3242L,3248L,3249L,3254L,3255L,3256L,3258L,3259L,3260L,3263L,3264L,3265L,3266L,3267L,3268L,3269L,3270L,3271L,3274L,3275L,3279L,3281L,2765L,
		2785L,2869L,2321L,2375L,2516L,1485L,1513L,1597L
);
	    // Build ElasticSearch query
	    BoolQueryBuilder boolQuery = QueryBuilders.boolQuery()
	            .must(QueryBuilders.termsQuery("id", FEATURED_PROPERTY_IDS));

	    // Build pagination and query
	    SearchSourceBuilder sourceBuilder = new SearchSourceBuilder()
	            .query(boolQuery)
	            .from(page * size)
	            .size(size);

	    // Create search request
	    SearchRequest searchRequest = new SearchRequest("propertysearchdocument");
	    searchRequest.source(sourceBuilder);

	    // Execute search
	    SearchResponse response = restHighLevelClient.search(searchRequest, RequestOptions.DEFAULT);

	    // Collect results
	    List<Map<String, Object>> results = new ArrayList<>();
	    for (org.elasticsearch.search.SearchHit hit : response.getHits().getHits()) {
	        results.add(hit.getSourceAsMap());
	    }

	    long totalElements = response.getHits().getTotalHits().value;
	    long totalPages = (long) Math.ceil((double) totalElements / size);

	    return new PaginatedResponse(results, totalElements, page, size, totalPages);
	}

	@GetMapping("/popularProperties")
	public PaginatedResponse searchPopularProperties(
	        @RequestParam(defaultValue = "0") int page,
	        @RequestParam(defaultValue = "10") int size) throws IOException {

	    // Use your static list of PROPERTY_IDS
		 List<Long> POPULAR_PROPERTY_IDS = Arrays.asList(
			    375L, 378L, 380L, 383L, 384L, 386L, 387L, 392L, 393L, 394L, 397L, 399L, 402L, 403L, 404L, 405L, 407L, 408L, 410L, 412L,
			    413L, 416L, 417L, 418L, 419L, 420L, 424L, 426L, 429L, 430L, 432L, 437L, 441L, 442L, 444L, 446L, 447L, 448L, 449L, 450L,
			    451L, 452L, 454L, 455L, 456L, 457L, 458L, 459L, 460L, 461L, 462L, 463L, 464L, 466L, 467L, 468L, 470L, 471L, 473L, 474L,
			    475L, 476L, 477L, 478L, 480L, 482L, 483L, 484L, 485L, 486L, 487L, 489L, 490L, 491L, 493L, 494L, 495L, 497L, 499L, 500L,
			    501L, 503L, 504L, 508L, 510L, 516L, 517L, 518L, 520L, 527L, 530L, 539L, 541L, 547L, 548L, 549L, 550L, 552L, 555L, 556L,
			    561L, 566L, 576L, 578L, 580L, 581L, 582L, 589L, 590L, 591L, 616L, 629L, 632L, 633L, 634L, 636L, 637L, 640L, 642L, 647L,
			    652L, 653L, 654L, 655L, 656L, 657L, 660L, 663L, 665L, 666L, 667L, 671L, 672L, 673L, 674L, 676L, 680L, 683L, 684L, 686L,
			    687L, 689L, 691L, 692L, 693L, 694L, 695L, 698L, 699L, 700L, 703L, 706L, 707L, 708L, 710L, 712L, 714L, 717L, 718L, 721L,
			    722L, 728L, 730L, 732L, 735L, 737L, 738L, 739L, 740L, 742L, 764L, 765L, 766L, 773L, 774L, 775L, 776L, 817L, 818L, 823L,
			    824L, 831L, 832L, 833L, 835L, 836L, 839L, 842L, 843L, 845L, 846L, 847L, 848L, 849L, 850L, 851L, 855L, 856L, 858L, 859L,
			    860L, 861L, 862L, 863L, 864L, 865L, 866L, 867L, 868L, 869L, 872L, 873L, 874L, 875L, 876L, 877L, 879L, 880L, 881L, 883L,
			    884L, 885L, 887L, 889L, 890L, 891L, 893L, 895L, 896L, 897L, 898L, 899L, 900L, 902L, 903L, 905L, 907L, 908L, 910L, 911L,
			    912L, 913L, 914L, 918L, 920L, 921L, 924L, 925L, 928L, 930L, 931L, 933L, 936L, 937L, 938L, 939L, 940L, 942L, 943L, 945L,
			    946L, 948L, 949L, 951L, 953L, 954L, 955L, 957L, 958L, 961L, 962L, 965L, 967L, 969L, 972L, 973L, 976L, 977L, 1015L, 1021L,
			    1024L, 1026L, 1027L, 1029L, 1031L, 1035L, 1036L, 1039L, 1041L, 1042L, 1044L, 1045L, 1053L, 1055L, 1057L, 1058L, 1061L,
			    1066L, 1068L, 1071L, 1075L, 1076L, 1077L, 1081L, 1089L, 1091L, 1094L, 1095L, 1097L, 1098L, 1099L, 1106L, 1109L, 1112L,
			    1115L, 1117L, 1118L, 1119L, 1120L, 1122L, 1124L, 1128L, 1130L, 1131L, 1134L, 1137L, 1138L, 1143L, 1146L, 1147L, 1150L,
			    1151L, 1153L, 1154L, 1155L, 1157L, 1158L, 1159L, 1160L, 1162L, 1163L, 1164L, 1166L, 1167L, 1168L, 1169L, 1171L, 1173L,
			    1176L, 1177L, 1178L, 1180L, 1181L, 1183L, 1186L, 1188L, 1190L, 1192L, 1193L, 1194L, 1196L, 1198L, 1200L, 1201L, 1202L,
			    1203L, 1205L, 1206L, 1207L, 1208L, 1210L, 1211L, 1212L, 1215L, 1216L, 1217L, 1218L, 1219L, 1220L, 1221L, 1225L, 1226L,
			    1229L, 1236L, 1237L, 1243L, 1244L, 1248L, 1249L, 1250L, 1251L, 1252L, 1254L, 1255L, 1256L, 1259L, 1262L, 1263L, 1264L,
			    1267L, 1268L, 1269L, 1271L, 1272L, 1273L, 1274L, 1277L, 1280L, 1281L, 1284L, 1285L, 1286L, 1289L, 1290L, 1291L, 1292L,
			    1295L, 1297L, 1301L, 1312L, 1313L, 1316L, 1317L, 1322L, 1326L, 1328L, 1330L, 1331L, 1332L, 1333L, 1334L, 1339L, 1340L,
			    1342L, 1343L, 1344L, 1346L, 1347L, 1348L, 1349L, 1350L, 1351L, 1353L, 1354L, 1355L, 1356L, 1359L, 1360L, 1362L, 1363L,
			    1364L, 1367L, 1369L, 1370L, 1372L, 1373L, 1374L, 1375L, 1376L, 1378L, 1379L, 1380L, 1381L, 1382L, 1383L, 1384L, 1385L,
			    1386L, 1387L, 1388L, 1389L, 1390L, 1391L, 1392L, 1393L, 1394L, 1396L, 1398L, 1399L, 1401L, 1402L, 1404L, 1406L, 1407L,
			    1408L, 1409L, 1411L, 1412L, 1414L, 1415L, 1416L, 1417L, 1418L, 1419L, 1420L, 1421L, 1423L, 1424L, 1426L, 1427L, 1429L,
			    1431L, 1432L, 1433L, 1434L, 1435L, 1437L, 1438L, 1439L, 1440L, 1441L, 1442L, 1443L, 1444L, 1446L, 1447L, 1448L, 1449L,
			    1450L, 1451L, 1452L, 1454L, 1455L, 1456L, 1457L, 1458L, 1459L, 1460L, 1461L, 1462L, 1465L, 1466L, 1467L, 1471L, 1474L,
			    1475L, 1476L, 1477L, 1479L, 1480L, 1484L, 1485L, 1486L, 1488L, 1491L, 1494L, 1495L, 1496L, 1497L, 1498L, 1499L, 1501L,
			    1502L, 1503L, 1504L, 1505L, 1506L, 1507L, 1508L, 1510L, 1511L, 1512L, 1513L, 1514L, 1515L, 1516L, 1517L, 1518L, 1519L,
			    1520L, 1521L, 1523L, 1524L, 1525L, 1526L, 1527L, 1528L, 1530L, 1535L, 1536L, 1537L, 1538L, 1539L, 1540L, 1541L, 1542L,
			    1544L, 1547L, 1549L, 1550L, 1551L, 1552L, 1553L, 1554L, 1556L, 1557L, 1558L, 1559L, 1561L, 1562L, 1563L, 1564L, 1565L,
			    1566L, 1567L, 1568L, 1569L, 1570L, 1571L, 1572L, 1573L, 1574L, 1575L, 1576L, 1578L, 1579L, 1580L, 1581L, 1582L, 1584L,
			    1585L, 1586L, 1588L, 1589L, 1590L, 1591L, 1592L, 1593L, 1594L, 1595L, 1596L, 1597L, 1598L, 1599L, 1600L, 1602L, 1603L,
			    1604L, 1606L, 1607L, 1608L, 1609L, 1615L, 1616L, 1619L, 1621L, 1622L, 1623L, 1626L, 1627L, 1628L, 1629L, 1630L, 1631L,
			    1632L, 1633L, 1634L, 1635L, 1636L, 1637L, 1639L, 1641L, 1642L, 1643L, 1644L, 1645L, 1647L, 1648L, 1649L, 1650L, 1651L,
			    1652L, 1653L, 1654L, 1655L, 1656L, 1657L, 1658L, 1660L, 1666L, 1667L, 1668L, 1669L, 1670L, 1671L, 1672L, 1673L, 1674L,
			    1675L, 1676L, 1677L, 1678L, 1679L, 1680L, 1681L, 1682L, 1684L, 1685L, 1686L, 1687L, 1688L, 1690L, 1691L, 1692L, 1694L,
			    1695L, 1696L, 1697L, 1698L, 1699L, 1700L, 1701L, 1702L, 1705L, 1706L, 1708L, 1709L, 1710L, 1712L, 1713L, 1714L, 1715L,
			    1716L, 1717L, 1718L, 1720L, 1721L, 1722L, 1723L, 1724L, 1725L, 1726L, 1728L, 1729L, 1730L, 1732L, 1733L, 1734L, 1736L,
			    1737L, 1738L, 1741L, 1742L, 1743L, 1744L, 1745L, 1746L, 1747L, 1748L, 1749L, 1750L, 1751L, 1752L, 1753L, 1754L, 1755L,
			    1756L, 1757L, 1758L, 1759L, 1760L, 1761L, 1762L, 1763L, 1764L, 1765L, 1766L, 1767L, 1770L, 1771L, 1773L, 1774L, 1775L,
			    1776L, 1777L, 1779L, 1780L, 1781L, 1782L, 1783L, 1784L, 1785L, 1786L, 1787L, 1788L, 1789L, 1790L, 1791L, 1792L, 1794L,
			    1795L, 1796L, 1797L, 1798L, 1799L, 1800L, 1801L, 1802L, 1803L, 1804L, 1805L, 1806L, 1807L, 1808L, 1810L, 1811L, 1812L,
			    1813L, 1814L, 1815L, 1816L, 1817L, 1819L, 1820L, 1821L, 1822L, 1823L, 1824L, 1825L, 1826L, 1827L, 1828L, 1831L, 1833L,
			    1834L, 1835L, 1836L, 1837L, 1839L, 1842L, 1843L, 1844L, 1845L, 1847L, 1851L, 1852L, 1857L, 1858L, 1859L, 1860L, 1861L,
			    1868L, 1869L, 1871L, 1872L, 1873L, 1874L, 1876L, 1877L, 1878L, 1879L, 1882L, 1883L, 1884L, 1886L, 1887L, 1888L, 1891L,
			    1893L, 1895L, 1896L, 1897L, 1903L, 1904L, 1907L, 1909L, 1910L, 1913L, 1914L, 1918L, 1919L, 1920L, 1924L, 1927L, 1928L,
			    1929L, 1930L, 1932L, 1935L, 1939L, 1940L, 1941L, 1944L, 1945L, 1947L, 1948L, 1949L, 1951L, 1952L, 1954L, 1955L, 1956L,
			    1957L, 1958L, 1962L, 1963L, 1970L, 1975L, 1976L, 1979L, 1980L, 1982L, 1985L, 1986L, 1987L, 1988L, 1998L, 2001L, 2004L,
			    2005L, 2006L, 2008L, 2009L, 2011L, 2015L, 2016L, 2019L, 2020L, 2022L, 2078L, 2101L, 2106L, 2110L, 2111L, 2126L, 2128L,
			    2129L, 2132L, 2135L, 2137L, 2138L, 2139L, 2141L, 2142L, 2145L, 2146L, 2147L, 2148L, 2149L, 2151L, 2155L, 2161L, 2162L,
			    2163L, 2164L, 2169L, 2170L, 2171L, 2172L, 2173L, 2174L, 2175L, 2177L, 2178L, 2179L, 2182L, 2184L, 2185L, 2186L, 2187L,
			    2191L, 2192L, 2194L, 2195L, 2214L, 2215L, 2216L, 2217L, 2218L, 2221L, 2222L, 2223L, 2224L, 2225L, 2226L, 2227L, 2228L,
			    2229L, 2230L, 2231L, 2233L, 2235L, 2237L, 2238L, 2246L, 2248L, 2249L, 2251L, 2253L, 2255L, 2256L, 2257L, 2258L, 2262L,
			    2265L, 2267L, 2268L, 2269L, 2271L, 2274L, 2276L, 2278L, 2279L, 2280L, 2281L, 2283L, 2296L, 2298L, 2299L, 2300L, 2302L,
			    2304L, 2305L, 2306L, 2309L, 2311L, 2312L, 2315L, 2316L, 2317L, 2318L, 2320L, 2321L, 2322L, 2324L, 2326L, 2327L, 2329L,
			    2330L, 2331L, 2332L, 2333L, 2335L, 2336L, 2337L, 2338L, 2339L, 2340L, 2341L, 2342L, 2345L, 2346L, 2347L, 2348L, 2349L,
			    2351L, 2353L, 2354L, 2355L, 2356L, 2357L, 2358L, 2360L, 2361L, 2363L, 2364L, 2365L, 2366L, 2367L, 2368L, 2370L, 2373L,
			    2374L, 2375L, 2376L, 2378L, 2386L, 2387L, 2388L, 2390L, 2391L, 2392L, 2393L, 2395L, 2397L, 2399L, 2400L, 2401L, 2402L,
			    2404L, 2405L, 2406L, 2407L, 2408L, 2409L, 2410L, 2411L, 2412L, 2413L, 2414L, 2417L, 2419L, 2421L, 2422L, 2423L, 2425L,
			    2429L, 2430L, 2431L, 2432L, 2433L, 2434L, 2435L, 2436L, 2439L, 2440L, 2441L, 2443L, 2444L, 2445L, 2446L, 2447L, 2448L,
			    2449L, 2450L, 2454L, 2455L, 2456L, 2458L, 2459L, 2461L, 2463L, 2464L, 2465L, 2466L, 2467L, 2469L, 2470L, 2471L, 2472L,
			    2473L, 2476L, 2478L, 2480L, 2481L, 2482L, 2483L, 2484L, 2489L, 2490L, 2492L, 2494L, 2497L, 2498L, 2501L, 2504L, 2505L,
			    2507L, 2513L, 2516L, 2518L, 2519L, 2520L, 2521L, 2522L, 2525L, 2526L, 2529L, 2531L, 2532L, 2534L, 2537L, 2539L, 2544L,
			    2545L, 2546L, 2547L, 2548L, 2549L, 2550L, 2553L, 2555L, 2557L, 2558L, 2559L, 2561L, 2564L, 2565L, 2566L, 2569L, 2570L,
			    2571L, 2572L, 2576L, 2578L, 2579L, 2580L, 2582L, 2585L, 2586L, 2587L, 2590L, 2591L, 2592L, 2595L, 2597L, 2599L, 2600L,
			    2602L, 2603L, 2604L, 2606L, 2609L, 2610L, 2611L, 2613L, 2615L, 2621L, 2622L, 2623L, 2624L, 2625L, 2626L, 2627L, 2628L,
			    2629L, 2631L, 2633L, 2634L, 2635L, 2636L, 2638L, 2639L, 2647L, 2648L, 2651L, 2652L, 2653L, 2656L, 2658L, 2659L, 2660L,
			    2663L, 2664L, 2666L, 2668L, 2669L, 2670L, 2671L, 2672L, 2673L, 2674L, 2678L, 2680L, 2684L, 2685L, 2686L, 2688L, 2691L,
			    2692L, 2693L, 2694L, 2695L, 2700L, 2713L, 2715L, 2716L, 2717L, 2718L, 2720L, 2721L, 2722L, 2723L, 2725L, 2726L, 2727L,
			    2728L, 2729L, 2730L, 2732L, 2733L, 2735L, 2736L, 2737L, 2738L, 2739L, 2740L, 2741L, 2743L, 2745L, 2746L, 2748L, 2750L,
			    2753L, 2756L, 2757L, 2759L, 2761L, 2764L, 2765L, 2769L, 2770L, 2771L, 2773L, 2774L, 2776L, 2777L, 2778L, 2779L, 2782L,
			    2783L, 2784L, 2785L, 2787L, 2788L, 2789L, 2790L, 2791L, 2794L, 2795L, 2799L, 2800L, 2803L, 2804L, 2805L, 2806L, 2810L,
			    2813L, 2814L, 2815L, 2816L, 2817L, 2818L, 2819L, 2820L, 2821L, 2823L, 2825L, 2826L, 2827L, 2828L, 2829L, 2830L, 2831L,
			    2832L, 2833L, 2834L, 2835L, 2836L, 2838L, 2839L, 2840L, 2841L, 2844L, 2845L, 2846L, 2847L, 2848L, 2849L, 2850L, 2852L,
			    2854L, 2855L, 2856L, 2858L, 2859L, 2860L, 2862L, 2863L, 2864L, 2865L, 2866L, 2867L, 2868L, 2869L, 2871L, 2873L, 2874L,
			    2877L, 2878L, 2880L, 2882L, 2883L, 2884L, 2885L, 2888L, 2890L, 2891L, 2892L, 2900L, 2901L, 2902L, 2903L, 2904L, 2905L,
			    2906L, 2907L, 2908L, 2909L, 2910L, 2911L, 2912L, 2913L, 2914L, 2915L, 2916L, 2917L, 2919L, 2920L, 2921L, 2922L, 2924L,
			    2925L, 2926L, 2927L, 2929L, 2930L, 2931L, 2932L, 2933L, 2935L, 2936L, 2937L, 2938L, 2939L, 2940L, 2941L, 2942L, 2943L,
			    2944L, 2945L, 2946L, 2947L, 2948L, 2949L, 2950L, 2951L, 2952L, 2953L, 2954L, 2955L, 2956L, 2957L, 2958L, 2959L, 2960L,
			    2961L, 2962L, 2964L, 2965L, 2967L, 2968L, 2969L, 2970L, 2971L, 2973L, 2975L, 2977L, 2979L, 2980L, 2981L, 2982L, 2985L,
			    2986L, 2987L, 2988L, 2989L, 2991L, 2992L, 2993L, 2994L, 2995L, 2996L, 2997L, 2998L, 2999L, 3001L, 3002L, 3004L, 3005L,
			    3006L, 3007L, 3008L, 3009L, 3010L, 3011L, 3012L, 3013L, 3014L, 3015L, 3016L, 3018L, 3020L, 3023L, 3024L, 3027L, 3029L,
			    3030L, 3031L, 3032L, 3034L, 3035L, 3036L, 3037L, 3040L, 3042L, 3043L, 3044L, 3045L, 3046L, 3047L, 3050L, 3051L, 3052L,
			    3053L, 3054L, 3055L, 3056L, 3057L, 3058L, 3059L, 3060L, 3061L,3062L, 3063L, 3064L, 3065L, 3066L, 3067L, 3068L, 3069L, 3071L, 3072L, 3073L, 3075L, 3076L, 3077L, 3078L, 3079L, 3080L, 3081L, 3082L, 3083L, 3084L, 3085L, 3086L, 3087L, 3088L, 3089L, 3090L, 3091L, 3092L, 3095L, 3096L, 3097L, 3101L, 3102L, 3103L, 3104L, 3105L, 3106L, 3107L, 3108L, 3109L, 3110L, 3111L, 3114L, 3115L, 3116L, 3117L, 3118L, 3119L, 3120L, 3121L, 3122L, 3124L, 3125L, 3126L, 3127L, 3128L, 3129L, 3130L, 3131L, 3132L, 3133L, 3134L, 3135L, 3136L, 3137L, 3138L, 3139L, 3140L, 3141L, 3142L, 3143L, 3144L, 3145L, 3146L, 3147L, 3148L, 3149L, 3150L, 3151L, 3152L, 3153L, 3154L, 3155L, 3156L, 3157L, 3158L, 3159L, 3160L, 3161L, 3162L, 3163L, 3164L, 3165L, 3166L, 3167L, 3168L, 3169L, 3170L, 3171L, 3172L, 3173L, 3174L, 3176L, 3177L, 3178L, 3179L, 3180L, 3181L, 3182L, 3183L, 3184L, 3185L, 3186L, 3187L, 3188L, 3189L, 3190L, 3192L, 3193L, 3194L, 3195L, 3196L, 3197L, 3199L, 3200L, 3201L, 3203L, 3204L, 3205L, 3206L, 3207L, 3208L, 3209L, 3210L, 3211L, 3212L, 3213L, 3214L, 3215L, 3216L, 3217L, 3218L, 3219L, 3220L, 3221L, 3222L, 3223L, 3225L, 3226L, 3227L, 3228L, 3229L, 3230L, 3231L, 3232L, 3233L, 3234L, 3235L, 3236L, 3237L, 3238L, 3239L, 3240L, 3241L, 3242L, 3243L, 3244L, 3245L, 3246L, 3247L, 3248L, 3249L, 3250L, 3251L, 3252L, 3254L, 3255L, 3256L, 3257L, 3258L, 3259L, 3260L, 3261L, 3262L, 3263L, 3264L, 3265L, 3266L, 3267L, 3268L, 3269L, 3270L, 3271L, 3274L, 3275L, 3276L, 3277L, 3278L, 3279L, 3280L, 3281L, 3282L, 3283L, 3284L, 3285L, 3286L, 3287L, 3288L, 3289L, 3290L, 3291L, 3292L, 3293L, 3294L, 3295L, 3296L, 3297L, 3298L, 3299L, 3300L, 3301L, 3302L, 3303L, 3304L, 3305L, 3306L, 3307L, 3308L, 3309L, 3310L, 3311L, 3312L, 3313L, 3314L, 3315L, 3316L, 3317L, 3318L, 3319L, 3320L, 3321L, 3322L, 3323L, 3324L, 3325L, 3326L, 3327L, 3328L, 3329L);



	    // Build ElasticSearch query
	    BoolQueryBuilder boolQuery = QueryBuilders.boolQuery()
	            .must(QueryBuilders.termsQuery("id", POPULAR_PROPERTY_IDS));

	    // Build pagination and query
	    SearchSourceBuilder sourceBuilder = new SearchSourceBuilder()
	            .query(boolQuery)
	            .from(page * size)
	            .size(size);

	    // Create search request
	    SearchRequest searchRequest = new SearchRequest("propertysearchdocument");
	    searchRequest.source(sourceBuilder);

	    // Execute search
	    SearchResponse response = restHighLevelClient.search(searchRequest, RequestOptions.DEFAULT);

	    // Collect results
	    List<Map<String, Object>> results = new ArrayList<>();
	    for (org.elasticsearch.search.SearchHit hit : response.getHits().getHits()) {
	        results.add(hit.getSourceAsMap());
	    }

	    long totalElements = response.getHits().getTotalHits().value;
	    long totalPages = (long) Math.ceil((double) totalElements / size);

	    return new PaginatedResponse(results, totalElements, page, size, totalPages);
	}
	/*
	private static final List<Long> POPULARHOTELMATE_PROPERTY_IDS = Arrays.asList(
			1426L, 1427L, 1429L,
			    1431L, 1432L, 1433L, 1434L, 1435L, 1437L, 1438L, 1439L, 1440L, 1441L, 1442L, 1443L,1446L, 1447L, 1448L, 1449L,
			    1450L, 1451L, 1452L, 1454L, 1455L, 1456L, 1457L, 1458L, 1459L, 1460L, 1461L, 1462L, 1465L, 1466L, 1467L, 1471L, 1474L,
			    1475L, 1476L, 1477L, 1479L, 1480L, 1484L, 1485L, 1486L, 1488L, 1491L, 1494L, 1495L, 1496L, 1497L, 1498L, 1499L, 1501L,
			    1502L, 1503L, 1504L, 1505L, 1506L, 1507L, 1508L, 1510L, 1511L, 1512L, 1513L, 1514L, 1515L, 1516L, 1517L, 1518L, 1519L,
			    1520L, 1521L, 1523L, 1524L, 1525L, 1526L, 1527L, 1528L, 1530L, 1535L, 1536L, 1537L, 1538L, 1539L, 1540L, 1541L, 1542L,
			    1544L, 1547L, 1549L, 1550L, 1551L, 1552L,1554L, 1556L, 1557L, 1558L, 1559L, 1561L, 1562L, 1563L, 1564L, 1565L,
			    1566L, 1567L, 1568L, 1569L, 1570L, 1571L, 1572L, 1573L, 1574L, 1575L, 1576L, 1578L, 1579L, 1580L, 1581L, 1582L, 1584L,
			    1585L, 1586L, 1588L, 1589L, 1590L, 1591L, 1592L, 1593L, 1594L, 1595L, 1596L, 1597L, 1598L, 1599L, 1600L, 1602L, 1603L,
			    1604L, 1606L, 1607L, 1608L, 1609L, 1615L, 1616L, 1619L, 1621L, 1622L, 1623L, 1626L, 1627L, 1628L, 1629L, 1630L, 1631L,
			    1632L, 1633L, 1634L, 1635L,1637L, 1639L, 1641L, 1642L, 1643L, 1644L, 1645L, 1647L, 1648L, 1649L, 1650L, 1651L,
			    1652L, 1653L, 1654L, 1655L, 1656L, 1657L, 1658L, 1660L, 1666L, 1667L, 1668L, 1669L, 1670L, 1671L, 1672L, 1673L, 1674L,
			    1675L, 1676L, 1677L, 1678L, 1679L, 1680L, 1681L, 1682L, 1684L, 1685L, 1686L, 1687L, 1688L, 1690L, 1691L, 1692L, 1694L,
			    1695L, 1696L, 1697L, 1698L, 1699L, 1700L, 1701L, 1702L, 1705L, 1706L, 1708L, 1709L, 1710L, 1712L, 1713L, 1714L, 1715L,
			    1716L, 1717L, 1718L, 1720L, 1721L, 1722L, 1723L, 1724L, 1725L, 1726L, 1728L, 1729L, 1730L, 1732L, 1733L, 1734L, 1736L,
			    1737L, 1738L, 1741L, 1742L, 1743L, 1744L, 1745L, 1746L, 1747L, 1748L, 1749L,1751L, 1752L, 1753L, 1754L, 1755L,
			    1756L, 1757L, 1758L, 1759L, 1760L, 1761L, 1762L, 1763L, 1764L, 1765L, 1766L, 1767L, 1770L, 1771L, 1773L, 1774L, 1775L,
			    1776L, 1777L, 1779L, 1780L, 1781L, 1782L, 1783L, 1784L, 1785L, 1786L, 1787L, 1788L, 1789L, 1790L, 1791L, 1792L, 1794L,
			    1795L, 1796L, 1797L, 1798L, 1799L, 1800L, 1801L, 1802L, 1803L, 1804L, 1805L, 1806L, 1807L, 1808L, 1810L, 1811L, 1812L,
			    1813L, 1814L, 1815L, 1816L, 1817L, 1819L, 1820L, 1821L, 1822L, 1823L, 1824L, 1825L, 1826L, 1827L, 1828L, 1831L, 1833L,
			    1834L,1836L, 1837L, 1839L, 1842L, 1843L, 1844L, 1845L, 1847L, 1851L, 1852L, 1857L, 1858L, 1859L, 1860L, 1861L,
			    1868L, 1869L, 1871L, 1872L, 1873L, 1874L, 1876L, 1877L, 1878L, 1879L, 1882L, 1883L, 1884L, 1886L, 1887L,1891L,
			    1895L, 1896L, 1897L, 1903L, 1904L, 1907L, 1909L, 1910L, 1913L, 1914L, 1918L, 1919L, 1920L, 1924L, 1927L, 1928L,
			    1929L, 1930L,1935L, 1939L, 1940L, 1941L, 1944L, 1945L, 1947L, 1948L, 1949L,1952L, 1954L, 1955L, 1956L,
			    1957L, 1958L, 1962L, 1963L,1975L, 1976L, 1979L,1982L, 1985L, 1986L, 1987L, 1988L,2004L,
			    2005L, 2006L, 2008L, 2009L, 2011L, 2015L, 2016L, 2019L, 2020L, 2022L, 2078L, 2101L,2110L, 2111L, 2126L, 2128L,
			    2129L, 2132L, 2135L, 2137L, 2138L, 2139L, 2141L, 2142L, 2145L, 2146L, 2147L, 2148L, 2149L, 2151L, 2155L, 2161L, 2162L,
			    2163L, 2164L, 2169L, 2170L, 2171L, 2172L, 2173L, 2174L, 2175L, 2177L, 2178L, 2179L, 2182L, 2184L, 2185L, 2186L, 2187L,
			    2191L, 2192L, 2194L, 2195L, 2214L, 2215L, 2216L, 2217L, 2218L, 2221L, 2222L, 2223L, 2224L, 2225L, 2226L, 2227L, 2228L,
			    2229L, 2230L, 2231L, 2233L, 2235L, 2237L, 2238L, 2246L, 2248L, 2249L, 2251L, 2253L, 2255L, 2256L, 2257L, 2258L, 2262L,
			    2265L, 2267L, 2268L, 2269L, 2271L, 2274L, 2276L, 2278L, 2279L, 2280L, 2281L, 2283L, 2296L, 2298L, 2299L, 2300L, 2302L,
			    2304L, 2305L, 2306L, 2309L, 2311L, 2312L, 2315L, 2316L, 2317L, 2318L, 2320L, 2321L, 2322L, 2324L, 2326L, 2327L, 2329L,
			    2330L, 2331L, 2332L, 2333L, 2335L, 2336L, 2337L, 2338L, 2339L, 2340L, 2341L, 2342L, 2345L, 2346L, 2347L, 2348L, 2349L,
			    2351L, 2353L, 2354L, 2355L, 2356L, 2357L, 2358L, 2360L, 2361L, 2363L, 2364L, 2365L, 2366L, 2367L, 2368L, 2370L, 2373L,
			    2374L, 2375L, 2376L, 2378L, 2386L, 2387L, 2388L, 2390L, 2391L, 2392L, 2393L, 2395L, 2397L, 2399L, 2400L, 2401L, 2402L,
			    2404L, 2405L, 2406L, 2407L, 2408L, 2409L, 2410L, 2411L, 2412L, 2413L, 2414L, 2417L, 2419L, 2421L, 2422L, 2423L, 2425L,
			    2429L, 2430L, 2431L, 2432L, 2433L, 2434L, 2435L, 2436L, 2439L, 2440L, 2441L, 2443L, 2444L, 2445L, 2446L, 2447L, 2448L,
			    2449L, 2450L, 2454L, 2455L, 2456L, 2458L, 2459L, 2461L, 2463L, 2464L, 2465L, 2466L, 2467L, 2469L, 2470L, 2471L, 2472L,
			    2473L, 2476L, 2478L, 2480L, 2481L, 2482L, 2483L, 2484L, 2489L, 2490L, 2492L, 2494L, 2497L, 2498L, 2501L, 2504L, 2505L,
			    2507L, 2513L, 2516L, 2518L, 2519L, 2520L, 2521L, 2522L, 2525L, 2526L, 2529L, 2531L, 2532L, 2534L, 2537L,2544L,
			    2545L, 2546L, 2547L, 2548L, 2549L, 2550L, 2553L, 2555L, 2557L, 2558L, 2559L, 2561L, 2564L, 2565L, 2566L, 2569L, 2570L,
			    2571L, 2572L, 2576L, 2578L, 2579L, 2580L, 2582L, 2585L, 2586L, 2587L, 2590L, 2591L, 2592L, 2595L, 2597L, 2599L, 2600L,
			    2602L, 2603L, 2604L, 2606L, 2609L,2611L, 2613L, 2615L, 2621L, 2622L, 2623L, 2624L, 2625L, 2626L, 2627L, 2628L,
			    2629L, 2631L, 2633L, 2634L, 2635L, 2636L, 2638L, 2639L, 2647L, 2648L, 2651L, 2652L, 2653L, 2656L, 2658L, 2659L, 2660L,
			    2663L, 2664L, 2666L, 2668L, 2669L, 2670L, 2671L, 2672L, 2673L, 2674L, 2678L, 2680L, 2684L, 2685L, 2686L, 2688L, 2691L,
			    2692L, 2693L, 2694L, 2695L, 2700L, 2713L, 2715L, 2716L, 2717L, 2718L, 2720L, 2721L, 2722L, 2723L, 2725L, 2726L, 2727L,
			    2728L, 2729L, 2730L, 2732L, 2733L, 2735L, 2736L, 2737L, 2738L, 2739L, 2740L, 2741L, 2743L, 2745L, 2746L, 2748L, 2750L,
			    2753L, 2756L, 2757L, 2759L, 2761L, 2764L, 2765L, 2769L, 2770L, 2771L, 2773L, 2774L, 2776L, 2777L, 2778L, 2779L, 2782L,
			    2783L, 2784L, 2785L, 2787L, 2788L, 2789L, 2790L, 2791L, 2794L, 2795L, 2799L, 2800L, 2803L, 2804L, 2805L, 2806L, 2810L,
			    2813L, 2814L, 2815L, 2816L, 2817L, 2818L, 2819L, 2820L, 2821L, 2823L, 2825L, 2826L, 2827L, 2828L, 2829L, 2830L, 2831L,
			    2832L, 2833L, 2834L, 2835L, 2836L, 2838L, 2839L, 2840L, 2841L, 2844L, 2845L, 2846L, 2847L, 2848L, 2849L, 2850L, 2852L,
			    2854L, 2855L, 2856L, 2858L, 2859L, 2860L, 2862L, 2863L, 2864L, 2865L, 2866L, 2867L, 2868L, 2869L, 2871L, 2873L, 2874L,
			    2877L, 2878L, 2880L, 2882L, 2883L, 2884L, 2885L, 2888L, 2890L, 2891L, 2892L, 2900L, 2901L, 2902L, 2903L, 2904L, 2905L,
			    2906L, 2907L, 2908L, 2909L, 2910L, 2911L, 2912L, 2913L, 2914L, 2915L, 2916L, 2917L, 2919L, 2920L, 2921L, 2922L, 2924L,
			    2925L, 2926L, 2927L, 2929L, 2930L, 2931L, 2932L, 2933L, 2935L, 2936L, 2937L, 2938L, 2939L, 2940L, 2941L, 2942L, 2943L,
			    2944L, 2945L, 2946L, 2947L, 2948L, 2949L, 2950L, 2951L, 2952L, 2953L, 2954L, 2955L, 2956L, 2957L, 2958L, 2959L, 2960L,
			    2961L, 2962L, 2964L, 2965L, 2967L, 2968L, 2969L, 2970L, 2971L, 2973L, 2975L, 2977L, 2979L, 2980L, 2981L, 2982L, 2985L,
			    2986L, 2987L, 2988L, 2989L, 2991L, 2992L, 2993L, 2994L, 2995L, 2996L, 2997L, 2998L, 2999L, 3001L, 3002L, 3004L, 3005L,
			    3006L, 3007L, 3008L, 3009L, 3010L, 3011L, 3012L, 3013L, 3014L, 3015L, 3016L, 3018L, 3020L, 3023L, 3024L, 3027L, 3029L,
			    3030L, 3031L, 3032L, 3034L, 3035L, 3036L, 3037L, 3040L, 3042L, 3043L, 3044L, 3045L, 3046L, 3047L, 3050L, 3051L, 3052L,
			    3053L, 3054L, 3055L, 3056L, 3057L, 3058L, 3059L, 3060L, 3061L,3062L, 3063L, 3064L, 3065L, 3066L, 3067L, 3068L, 3069L, 3071L, 3072L, 3073L, 3075L, 3076L, 3077L, 3078L, 3079L, 3080L, 3081L, 3082L, 3083L, 3084L, 3085L, 3086L, 3087L, 3088L, 3089L, 3090L, 3091L, 3092L, 3095L, 3096L, 3097L, 3101L, 3102L, 3103L, 3104L, 3105L, 3106L, 3107L, 3108L, 3109L, 3110L, 3111L, 3114L, 3115L, 3116L, 3117L, 3118L, 3119L, 3120L, 3121L, 3122L, 3124L, 3125L, 3126L, 3127L, 3128L, 3129L, 3130L, 3131L, 3132L, 3133L, 3134L, 3135L, 3136L, 3137L, 3138L, 3139L, 3140L, 3141L, 3142L, 3143L, 3144L, 3145L, 3146L, 3147L, 3148L, 3149L, 3150L, 3151L, 3152L, 3153L, 3154L, 3155L, 3156L, 3157L, 3158L, 3159L, 3160L, 3161L, 3162L, 3163L, 3164L, 3165L, 3166L, 3167L, 3168L, 3169L, 3170L, 3171L, 3172L, 3173L, 3174L, 3176L, 3177L, 3178L, 3179L, 3180L, 3181L, 3182L, 3183L, 3184L, 3185L, 3186L, 3187L, 3188L, 3189L, 3190L, 3192L, 3193L, 3194L, 3195L, 3196L, 3197L, 3199L, 3200L, 3201L, 3203L, 3204L, 3205L, 3206L, 3207L, 3208L, 3209L, 3210L, 3211L, 3212L, 3213L, 3214L, 3215L, 3216L, 3217L, 3218L, 3219L, 3220L, 3221L, 3222L, 3223L, 3225L, 3226L, 3227L, 3228L, 3229L, 3230L, 3231L, 3232L, 3233L, 3234L, 3235L, 3236L, 3237L, 3238L, 3239L, 3240L, 3241L,3243L, 3244L, 3245L,3247L, 3248L, 3249L, 3250L, 3251L, 3252L, 3254L, 3255L, 3256L, 3257L, 3258L, 3259L, 3260L, 3261L, 3262L, 3263L, 3264L, 3265L, 3266L, 3267L, 3268L, 3269L, 3270L, 3271L, 3274L, 3275L, 3276L, 3277L, 3278L, 3279L, 3280L, 3281L, 3282L, 3283L, 3284L, 3285L, 3286L, 3287L, 3288L, 3289L, 3290L, 3291L, 3292L, 3293L, 3294L, 3295L, 3296L, 3297L, 3298L, 3299L, 3300L, 3301L, 3302L, 3303L, 3304L, 3305L, 3306L, 3307L, 3308L, 3309L, 3310L, 3311L, 3312L,3314L, 3315L, 3316L, 3317L,3319L, 3320L, 3321L,3324L, 3325L, 3326L, 3327L, 3328L, 3329L,
			    375L, 378L, 380L, 383L,392L,407L, 408L, 410L,
			    413L, 416L, 417L, 418L, 420L, 424L, 426L, 429L, 430L, 432L, 437L, 441L, 442L, 444L, 446L, 447L, 448L, 449L, 450L,
			    451L, 452L, 454L, 455L, 456L, 457L, 458L, 459L, 460L, 461L, 462L, 463L, 464L, 466L, 467L, 468L, 470L, 471L, 473L, 474L,
			    475L, 476L, 477L, 478L, 482L, 483L, 484L, 485L, 486L, 487L, 489L, 490L,493L, 494L, 495L, 497L,
			    501L,504L, 508L, 510L, 516L, 517L, 518L, 520L, 527L, 530L, 539L, 541L, 547L,549L, 550L, 552L, 555L, 556L,
			    561L, 566L, 576L, 578L, 580L, 581L, 582L, 589L, 590L, 591L, 616L, 629L,633L, 634L,637L, 640L, 642L, 647L,
			    652L, 653L, 654L, 655L, 656L, 657L, 660L, 663L, 665L, 666L, 667L, 671L, 672L, 673L, 674L, 676L, 680L, 683L, 684L, 686L,
			    687L,691L, 692L, 693L, 694L, 695L, 698L, 699L, 700L, 703L, 706L, 707L, 708L, 710L, 712L, 714L, 717L, 718L, 721L,
			    722L,730L, 732L,737L,739L, 740L, 742L, 764L, 765L, 766L, 773L, 774L, 775L, 776L, 817L, 818L, 823L,
			    824L, 831L, 832L, 833L, 835L,839L, 842L, 843L, 845L, 846L, 847L, 848L, 849L, 850L, 851L, 855L, 856L, 858L, 859L,
			    860L, 861L, 862L, 863L, 864L, 865L, 866L, 867L, 868L, 869L, 872L, 873L, 874L, 875L, 876L, 877L, 879L, 880L, 881L, 883L,
			    884L, 885L, 887L, 889L, 890L,893L, 895L, 896L, 897L, 898L, 899L, 900L, 902L, 903L, 905L, 907L, 908L, 910L, 911L,
			    912L, 913L, 914L, 918L, 920L, 921L, 924L, 925L, 928L, 930L, 931L, 933L, 936L, 937L, 938L, 939L, 940L, 942L, 943L, 945L,
			    946L, 948L, 949L, 951L, 953L, 954L, 955L, 957L, 958L, 961L, 962L, 965L, 967L,972L,976L, 977L, 1015L, 1021L,
			    1024L, 1026L, 1027L, 1029L, 1031L, 1035L, 1036L, 1039L,1042L, 1044L, 1045L, 1053L, 1055L, 1057L, 1058L, 1061L,
			    1066L, 1068L, 1071L, 1075L, 1076L, 1077L, 1081L,1091L, 1094L, 1095L, 1097L, 1098L, 1099L, 1106L, 1109L, 1112L,
			    1115L, 1117L, 1118L, 1119L, 1120L, 1122L, 1124L, 1128L, 1130L, 1131L, 1134L, 1137L, 1138L, 1143L, 1146L, 1147L, 1150L,
			    1151L, 1153L, 1154L, 1155L, 1157L, 1158L, 1159L, 1160L, 1162L, 1163L,1166L, 1167L, 1168L, 1169L, 1171L, 1173L,
			    1176L, 1177L, 1178L, 1180L, 1181L, 1183L, 1186L, 1188L, 1190L, 1192L, 1193L, 1194L, 1196L, 1198L, 1200L, 1201L, 1202L,
			    1203L,1206L, 1207L,1210L, 1211L, 1212L, 1215L,1217L, 1218L, 1219L, 1220L, 1221L, 1225L, 1226L,
			    1229L, 1236L, 1237L, 1243L, 1244L, 1248L,1250L,1252L, 1254L, 1255L, 1256L, 1259L, 1262L, 1263L, 1264L,
			    1267L, 1268L, 1269L, 1271L, 1272L,1274L, 1277L, 1280L, 1281L, 1284L,1286L, 1289L, 1290L, 1291L, 1292L,
			    1295L, 1297L, 1301L, 1312L, 1313L,1317L, 1322L, 1326L, 1328L, 1330L, 1331L, 1332L, 1333L,1339L, 1340L,
			    1342L, 1343L, 1344L, 1346L, 1347L, 1348L, 1349L, 1350L, 1351L, 1353L, 1354L, 1355L, 1356L, 1359L, 1360L, 1362L, 1363L,
			    1364L, 1367L, 1369L, 1370L, 1372L, 1373L, 1374L, 1375L, 1376L, 1378L, 1379L, 1380L, 1381L, 1382L, 1383L, 1384L, 1385L,
			    1386L, 1387L, 1388L, 1389L, 1390L, 1391L, 1392L, 1393L, 1394L, 1396L, 1398L, 1399L, 1401L, 1402L, 1404L, 1406L, 1407L,
			    1408L, 1409L, 1411L, 1412L, 1414L, 1415L, 1416L, 1417L, 1418L, 1419L, 1420L, 1421L, 1423L, 1424L);
*/
	private static final List<Long> POPULARHOTELMATE_PROPERTY_IDS = Arrays.asList(2536L,2228L,2665L,2543L,1092L,2233L,2468L,1231L,1418L,2932L,2612L,2887L,
	    1525L,3058L,2568L,1953L,1576L,3067L,2167L,1610L,1637L,3081L,1703L,1352L,
	    1747L,3243L,2662L,434L,1914L,1431L,916L,2185L,1746L,1213L,2214L,1792L,
	    2744L,2215L,2016L,1240L,2217L,2187L,1587L,2223L,2349L,2976L,2224L,2356L,
	    2654L,2251L,2400L,315L,2304L,2413L,2389L,2318L,2444L,1856L,2376L,2497L,
	    1665L,2392L,2550L,2499L,2402L,2910L,2593L,2409L,2942L,1704L,2410L,2949L,
	    1090L,2417L,2971L,2428L,2508L,2006L,2474L,2697L,2421L,3068L,1483L,2436L,
	    3106L,2966L,2603L,3129L,2978L,3034L,3131L,2876L,3040L,3134L,1490L,3044L,
	    3136L,2808L,3061L,3137L,2792L,1529L,1422L,2551L,267L,311L,359L,1495L,1521L,1656L,1485L,1513L,1597L
);
	
	

		@GetMapping("/searchThmPopular")
		public PaginatedResponse searchThmPopularProperties(
		        @RequestParam(required = false) String city,
		        @RequestParam(required = false) Long propertyId,
		        @RequestParam(required = false) String source,
		        @RequestParam(required = false) String name,
		        @RequestParam(required = false) String businessSubtype,
		        @RequestParam(defaultValue = "0") int page,
		        @RequestParam(defaultValue = "10") int size) throws IOException {

		    BoolQueryBuilder boolQuery = QueryBuilders.boolQuery();

		    // Filter only popular properties
		    boolQuery.must(QueryBuilders.termsQuery("id", POPULARHOTELMATE_PROPERTY_IDS));

		    if (city != null && !city.isEmpty()) {
		        boolQuery.must(QueryBuilders.matchQuery("address.city", city));
		    }
		    if (propertyId != null) {
		        boolQuery.must(QueryBuilders.termQuery("id", propertyId));
		    }
		    if (source != null && !source.isEmpty()) {
		        boolQuery.must(QueryBuilders.termQuery("source", source));
		    }
		    if (name != null && !name.isEmpty()) {
		        boolQuery.must(QueryBuilders.termQuery("name.keyword", name));
		    }
		    if (businessSubtype != null && !businessSubtype.isEmpty()) {
		        boolQuery.must(QueryBuilders.termQuery("businessSubtype.keyword", businessSubtype));
		    }

		    SearchSourceBuilder sourceBuilder = new SearchSourceBuilder()
		            .query(boolQuery)
		            .from(page * size)
		            .size(size);

		    SearchRequest searchRequest = new SearchRequest("propertysearchdocument");
		    searchRequest.source(sourceBuilder);

		    SearchResponse response = restHighLevelClient.search(searchRequest, RequestOptions.DEFAULT);

		    List<Map<String, Object>> results = new ArrayList<>();
		    for (org.elasticsearch.search.SearchHit hit : response.getHits().getHits()) {
		        results.add(hit.getSourceAsMap());
		    }

		    long totalElements = response.getHits().getTotalHits().value;
		    long totalPages = (long) Math.ceil((double) totalElements / size);

		    return new PaginatedResponse(results, totalElements, page, size, totalPages);
		}


}
